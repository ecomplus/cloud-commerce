---
import type { HeroSliderProps } from '@@sf/layouts/main/use-page-hero';
import Picture from '@@sf/components/Picture.astro';

export type Props = HeroSliderProps['slides'][0] & {
  index: number;
  widths?: number[];
  class?: string;
  mobileWidths?: number[];
  mobileClass?: string;
};

const {
  img,
  alt,
  mobileImg,
  title,
  subtitle,
  buttonText,
  index,
  class: className = 'max-w-screen-2xl',
  mobileClass = 'max-w-screen-sm',
} = Astro.props as Props;
const hasHeader = title || subtitle || buttonText;
let { widths, mobileWidths } = Astro.props;
if (!widths?.length) {
  if (mobileImg) {
    widths = [1536, 2048];
  } else {
    widths = [856, 1536, 2048];
    if (hasHeader) {
      widths = widths.map((w) => (w / 2));
    }
  }
}
if (!mobileWidths?.length) {
  mobileWidths = [720, 856];
}
---

<Picture
  src={img}
  alt={alt || ''}
  widths={widths}
  fetchpriority={index === 0 ? 'high' : 'low'}
  loading={index === 0 ? 'eager' : 'lazy'}
  class={`${(mobileImg ? 'hidden md:block ' : '')}mx-auto ${className}`}
/>
{mobileImg &&
  <Picture
    src={mobileImg}
    alt={alt || ''}
    widths={mobileWidths}
    fetchpriority={index === 0 ? 'high' : 'low'}
    loading={index === 0 ? 'eager' : 'lazy'}
    class={`md:hidden mx-auto ${mobileClass}`}
  />
}

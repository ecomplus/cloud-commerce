---
import type { PageContext } from '@@sf/ssr-context';
import BaseHead from '@@sf/layouts/BaseHead.astro';
import BaseStateJson from '@@sf/layouts/BaseStateJson.astro';
import BaseBody from '@@sf/layouts/BaseBody.astro';

export interface Props {
  pageContext: PageContext;
  title?: string;
}

const { pageContext, title } = Astro.props as Props;
const { cms } = pageContext;
const cmsCustomCode = await cms('code');
---

<head>
  <BaseHead pageContext={pageContext} title={title} />
  <BaseStateJson pageContext={pageContext} />
  {cmsCustomCode?.css && <style>{cmsCustomCode.css}</style>}
  {cmsCustomCode?.html_head && <Fragment set:html={cmsCustomCode.html_head} />}
  <slot name="base-head-scripts">
    <script src="../scripts/modules-info-preset"></script>
  </slot>
  <slot name="before-head-end" />
</head>
<BaseBody pageContext={pageContext}>
  <slot />
  {cmsCustomCode?.html_body && <Fragment set:html={cmsCustomCode.html_body} />}
  <slot name="base-body-scripts">
    <script src="../scripts/session-utm"></script>
  </slot>
  <slot name="before-body-end" />
</BaseBody>

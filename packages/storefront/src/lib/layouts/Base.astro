---
import type { PageContext } from '@@sf/ssr-context';
import BaseHead from '@@sf/layouts/BaseHead.astro';
import BaseStateJson from '@@sf/layouts/BaseStateJson.astro';
import BaseBody from '@@sf/layouts/BaseBody.astro';

export interface Props {
  pageContext: PageContext;
  title?: string;
}

const { pageContext, title } = Astro.props as Props;
const { getContent } = pageContext;
const { custom_code: customCodeContent } = await getContent('layout');
---

<head>
  <BaseHead pageContext={pageContext} title={title} />
  <BaseStateJson pageContext={pageContext} />
  {customCodeContent?.css && <style>{customCodeContent.css}</style>}
  {customCodeContent?.html_head && <Fragment set:html={customCodeContent.html_head} />}
  <slot name="base-head-scripts">
    <script src="../scripts/modules-info-preset"></script>
  </slot>
  <slot name="before-head-end" />
</head>
<BaseBody pageContext={pageContext}>
  <slot />
  {customCodeContent?.html_body && <Fragment set:html={customCodeContent.html_body} />}
  <slot name="base-body-scripts">
    <script src="../scripts/session-utm"></script>
  </slot>
  <slot name="before-body-end" />
</BaseBody>

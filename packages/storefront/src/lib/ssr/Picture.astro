---
import { Picture } from '@astrojs/image/components';
import { getAspectRatio } from '@@sf/ssr/image';

type PictureProps = Parameters<typeof Picture>[0];

export type Props = Omit<PictureProps, 'aspectRatio'> & {
  aspectRatio?: PictureProps['aspectRatio'],
  fetchpriority: 'high' | 'low' | 'auto',
};

const props = Astro.props as PictureProps;
if (!props.aspectRatio && typeof props.src === 'string') {
  props.aspectRatio = getAspectRatio(props.src);
}
---

<Picture {...props} />
